# 快速入门

## 目录
1. [系统要求](#系统要求)
2. [环境准备](#环境准备)
3. [部署方式](#部署方式)
4. [配置说明](#配置说明)
5. [启动服务](#启动服务)
6. [访问界面](#访问界面)
7. [首次使用](#首次使用)
8. [常见问题](#常见问题)

## 系统要求

AgentChat系统支持多种部署方式，以下是各部署方式的系统要求：

### Docker部署方式
- **Docker**: 20.10+
- **Docker Compose**: 2.0+
- **内存**: 最少4GB，推荐8GB+
- **磁盘**: 最少10GB可用空间

### 本地开发方式
- **Python**: 3.12+
- **Node.js**: 18+
- **MySQL**: 8.0+
- **Redis**: 7.0+

## 环境准备

### 1. 安装Python 3.12+

```bash
# Windows系统
# 下载并安装：https://www.python.org/downloads/

# macOS系统
brew install python@3.12

# Linux系统（Ubuntu/Debian）
sudo apt update
sudo apt install python3.12 python3.12-venv python3.12-pip
```

### 2. 安装Node.js

```bash
# Windows/macOS系统
# 下载并安装：https://nodejs.org/

# Linux系统（Ubuntu/Debian）
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs
```

### 3. 安装Docker（推荐）

```bash
# Windows/macOS系统
# 下载并安装：https://www.docker.com/products/docker-desktop

# Linux系统（Ubuntu/Debian）
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo systemctl enable docker
sudo systemctl start docker
```

### 4. 验证安装

```bash
# 验证Python版本
python --version  # 应显示Python 3.12或更高版本

# 验证Node.js版本
node --version   # 应显示Node.js 18或更高版本

# 验证Docker版本
docker --version # 应显示Docker 20.10或更高版本
```

## 部署方式

AgentChat提供两种主要部署方式：Docker快速部署和源码本地部署。

### 方式一：Docker一键部署（推荐）

这是最简单的部署方式，适合快速体验和开发测试。

#### 步骤1：克隆项目

```bash
git clone https://github.com/Shy2593666979/AgentChat.git
cd AgentChat
```

#### 步骤2：配置API密钥

```bash
# 复制配置模板
cp docker/docker.env.example docker/docker.env

# 编辑配置文件，填入你的API密钥
vim docker/docker.env
```

需要配置的主要API密钥：
- **OpenAI API密钥**: `OPENAI_API_KEY=sk-your-openai-api-key`
- **Anthropic API密钥**: `ANTHROPIC_API_KEY=sk-ant-your-key`
- **通义千问 API密钥**: `QWEN_API_KEY=sk-your-qwen-api-key`

#### 步骤3：启动服务

```bash
cd docker
docker-compose up --build -d
```

### 方式二：源码本地部署

适合开发者深入学习和二次开发。

#### 步骤1：克隆项目

```bash
git clone https://github.com/Shy2593666979/AgentChat.git
cd AgentChat
```

#### 步骤2：安装后端依赖

```bash
# 创建Python虚拟环境（可选但推荐）
python -m venv agentchat-env
source agentchat-env/bin/activate  # Linux/macOS
# agentchat-env\Scripts\activate    # Windows

# 安装依赖
pip install -r requirements.txt
```

#### 步骤3：配置后端

```bash
# 复制配置文件
cp src/backend/agentchat/config.yaml.example src/backend/agentchat/config.yaml

# 编辑配置文件，填入你的API密钥
vim src/backend/agentchat/config.yaml
```

#### 步骤4：启动后端服务

```bash
cd src/backend
uvicorn agentchat.main:app --port 7860 --host 0.0.0.0
```

#### 步骤5：启动前端服务

```bash
# 在另一个终端窗口
cd src/frontend
npm install
npm run dev
```

## 配置说明

### 环境变量配置

AgentChat使用环境变量进行配置管理，主要配置文件位于`docker/docker.env`。

#### 必需配置项

```bash
# AI模型配置
OPENAI_API_KEY=sk-your-openai-api-key-here
ANTHROPIC_API_KEY=sk-ant-your-anthropic-key-here
QWEN_API_KEY=sk-your-qwen-api-key-here

# 数据库配置
MYSQL_ROOT_PASSWORD=123456
MYSQL_PASSWORD=your-secure-password

# 安全配置
JWT_SECRET_KEY=your-super-secret-jwt-key-change-in-production-environment
```

#### 可选配置项

```bash
# 搜索服务配置
GOOGLE_API_KEY=your-google-api-key
GOOGLE_CSE_ID=your-google-search-engine-id
TAVILY_API_KEY=your-tavily-api-key

# 邮件服务配置
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
```

### 后端配置文件

主要配置文件：`src/backend/agentchat/config.yaml`

#### 数据库连接配置

```yaml
mysql:
  endpoint: "mysql+pymysql://root:mingguang@localhost:3306/agentchat"
  async_endpoint: "mysql+aiomysql://root:mingguang@localhost:3306/agentchat"
```

#### LLM API配置

```yaml
multi_models:
  conversation_model:
    api_key: "sk-6d47d94f4c734357903******"
    base_url: "https://api.deepseek.com/v1"
    model_name: "deepseek-chat"
```

#### 向量数据库配置

```yaml
rag:
  vector_db:
    host: "127.0.0.1"
    port: "19530"
    mode: "chroma"  # 或 "milvus"
```

## 启动服务

### Docker部署启动

```bash
# 进入docker目录
cd docker

# 设置执行权限
chmod +x start.sh stop.sh

# 启动所有服务
./start.sh

# 查看服务状态
docker-compose ps

# 查看日志
docker-compose logs -f
```

### 源码部署启动

```bash
# 后端服务
cd src/backend
uvicorn agentchat.main:app --port 7860 --host 0.0.0.0

# 前端服务（新开终端）
cd src/frontend
npm install
npm run dev
```

## 访问界面

系统启动完成后，可以通过以下地址访问：

| 服务 | 地址 | 说明 |
|------|------|------|
| 前端界面 | http://localhost:8090 | Vue3开发服务器 |
| 后端API | http://localhost:7860 | FastAPI应用服务 |
| API文档 | http://localhost:7860/docs | Swagger在线文档 |

## 首次使用

### 1. 注册账号

访问 http://localhost:8090，点击注册按钮创建新账号。

### 2. 登录系统

使用刚刚注册的账号登录系统。

### 3. 第一次对话测试

登录成功后，您可以在聊天界面输入问题，系统会返回AI生成的回答。

```bash
# 示例对话
用户：你好，介绍一下自己
AI：你好！我是AgentChat智能助手...
```

### 4. 配置AI模型

首次使用前，建议检查并配置AI模型：

1. 进入"配置"页面
2. 设置您的API密钥
3. 选择默认使用的AI模型
4. 调整对话参数

## 常见问题

### 1. 端口冲突

**问题**: 端口已被占用
```bash
# 检查端口占用
lsof -i :7860  # 检查后端端口
lsof -i :8090  # 检查前端端口

# 修改docker-compose.yml中的端口映射
ports:
  - "17860:7860"  # 改为其他可用端口
```

### 2. 依赖安装失败

**问题**: pip或npm依赖安装失败
```bash
# 清理pip缓存
pip cache purge

# 更新pip
pip install --upgrade pip

# 使用国内镜像源
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/
```

### 3. 数据库连接失败

**问题**: MySQL连接失败
```bash
# 检查MySQL容器状态
docker-compose ps mysql

# 进入MySQL容器
docker-compose exec mysql mysql -u root -p

# 重置数据库
docker-compose down mysql
docker volume rm docker_mysql_data
docker-compose up -d mysql
```

### 4. API密钥错误

**问题**: AI模型API调用失败
```bash
# 检查环境变量
docker-compose exec backend printenv | grep API_KEY

# 重新设置环境变量
vim docker/docker.env
docker-compose restart backend
```

### 5. 性能优化

**开发环境优化**:
```yaml
# docker-compose.override.yml
version: '3.8'
services:
  backend:
    volumes:
      - ../src/backend:/app:cached
    environment:
      - PYTHONUNBUFFERED=1
      - PYTHONDONTWRITEBYTECODE=1
```

**生产环境配置**:
```bash
# 使用生产配置
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d
```

### 6. 日志排查

```bash
# 查看所有服务日志
docker-compose logs -f

# 查看特定服务日志
docker-compose logs -f backend
docker-compose logs -f frontend

# 查看最近100行日志
docker-compose logs --tail=100 backend
```

### 7. 服务重启

```bash
# 重启特定服务
docker-compose restart backend

# 重新构建并启动
docker-compose up --build -d

# 停止所有服务
./stop.sh
```

通过以上步骤，您应该能够成功部署并运行AgentChat系统。如果遇到任何问题，请参考项目的GitHub仓库获取更多帮助和支持。
