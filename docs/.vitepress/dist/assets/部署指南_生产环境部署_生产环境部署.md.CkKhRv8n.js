import{_ as n,c as a,o as i,ag as e}from"./chunks/framework.7BqJGZTL.js";const E=JSON.parse('{"title":"生产环境部署","description":"","frontmatter":{},"headers":[],"relativePath":"部署指南/生产环境部署/生产环境部署.md","filePath":"部署指南/生产环境部署/生产环境部署.md","lastUpdated":1764244560000}'),l={name:"部署指南/生产环境部署/生产环境部署.md"};function p(r,s,t,h,c,o){return i(),a("div",null,[...s[0]||(s[0]=[e(`<h1 id="生产环境部署" tabindex="-1">生产环境部署 <a class="header-anchor" href="#生产环境部署" aria-label="Permalink to &quot;生产环境部署&quot;">​</a></h1><cite> **本文档引用文件** - [docker-compose.prod.yml](https://github.com/Shy2593666979/AgentChat/docker/docker-compose.prod.yml) - [nginx.conf](https://github.com/Shy2593666979/AgentChat/docker/nginx.conf) - [Dockerfile](https://github.com/Shy2593666979/AgentChat/docker/Dockerfile) - [Dockerfile.frontend.prod](https://github.com/Shy2593666979/AgentChat/docker/Dockerfile.frontend.prod) - [start.sh](https://github.com/Shy2593666979/AgentChat/docker/start.sh) - [stop.sh](https://github.com/Shy2593666979/AgentChat/docker/stop.sh) - [docker.env.example](https://github.com/Shy2593666979/AgentChat/docker/docker.env.example) - [main.py](https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/main.py) - [settings.py](https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/settings.py) - [config.yaml](https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/config.yaml) </cite><h2 id="目录" tabindex="-1">目录 <a class="header-anchor" href="#目录" aria-label="Permalink to &quot;目录&quot;">​</a></h2><ol><li><a href="#简介">简介</a></li><li><a href="#项目结构">项目结构</a></li><li><a href="#核心组件">核心组件</a></li><li><a href="#架构概述">架构概述</a></li><li><a href="#详细组件分析">详细组件分析</a></li><li><a href="#依赖分析">依赖分析</a></li><li><a href="#性能考虑">性能考虑</a></li><li><a href="#故障排除指南">故障排除指南</a></li><li><a href="#结论">结论</a></li></ol><h2 id="简介" tabindex="-1">简介 <a class="header-anchor" href="#简介" aria-label="Permalink to &quot;简介&quot;">​</a></h2><p>本指南详细说明了从开发到生产环境的配置演进过程，重点介绍基于 <code>docker-compose.prod.yml</code> 的生产级服务配置。内容涵盖后端使用Gunicorn多工作进程部署、前端生产镜像构建、MySQL性能优化参数（如InnoDB缓冲池、最大连接数）、Redis持久化与内存策略，以及Nginx生产配置（包括反向代理规则、静态资源缓存策略、Gzip压缩和安全头）。同时，指南还说明了如何通过环境变量注入敏感信息，并指导配置HTTPS（可结合Let&#39;s Encrypt），最后提供部署验证步骤以确保高可用性和性能优化措施生效。</p><h2 id="项目结构" tabindex="-1">项目结构 <a class="header-anchor" href="#项目结构" aria-label="Permalink to &quot;项目结构&quot;">​</a></h2><p>本项目采用前后端分离架构，使用Docker进行容器化部署。核心结构包括后端服务（FastAPI）、前端应用（Vue 3）、MySQL数据库、Redis缓存和Nginx反向代理。</p><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph TB</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subgraph &quot;前端&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Frontend[前端应用]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Nginx[Nginx服务器]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subgraph &quot;后端&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Backend[FastAPI后端]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Gunicorn[Gunicorn]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Uvicorn[Uvicorn Worker]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subgraph &quot;数据存储&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MySQL[MySQL数据库]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Redis[Redis缓存]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Frontend --&gt; Nginx</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Nginx --&gt; Backend</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Backend --&gt; MySQL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Backend --&gt; Redis</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Backend --&gt; ExternalAPIs[(外部API)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style Frontend fill:#4CAF50,stroke:#388E3C</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style Nginx fill:#2196F3,stroke:#1976D2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style Backend fill:#FF9800,stroke:#F57C00</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style Gunicorn fill:#FF5722,stroke:#D84315</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style Uvicorn fill:#FFC107,stroke:#FFA000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style MySQL fill:#009688,stroke:#00796B</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style Redis fill:#E91E63,stroke:#C2185B</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p><strong>图示来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/docker/docker-compose.prod.yml#L6-L52" target="_blank" rel="noreferrer">docker-compose.prod.yml</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/docker/nginx.conf#L66-L101" target="_blank" rel="noreferrer">nginx.conf</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/docker/Dockerfile#L2-L39" target="_blank" rel="noreferrer">Dockerfile</a></li></ul><p><strong>本节来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/docker/docker-compose.prod.yml#L1-L52" target="_blank" rel="noreferrer">docker-compose.prod.yml</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/docker/nginx.conf#L1-L101" target="_blank" rel="noreferrer">nginx.conf</a></li></ul><h2 id="核心组件" tabindex="-1">核心组件 <a class="header-anchor" href="#核心组件" aria-label="Permalink to &quot;核心组件&quot;">​</a></h2><p>本系统的核心组件包括使用Gunicorn部署的FastAPI后端、基于Vue 3的前端应用、MySQL数据库、Redis缓存和Nginx反向代理服务器。生产环境通过Docker Compose进行编排，确保各服务的高可用性和性能优化。</p><p><strong>本节来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/docker/docker-compose.prod.yml#L1-L52" target="_blank" rel="noreferrer">docker-compose.prod.yml</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/main.py#L1-L108" target="_blank" rel="noreferrer">main.py</a></li></ul><h2 id="架构概述" tabindex="-1">架构概述 <a class="header-anchor" href="#架构概述" aria-label="Permalink to &quot;架构概述&quot;">​</a></h2><p>系统采用现代化的微服务架构，前端通过Nginx反向代理与后端API通信。后端使用Gunicorn作为WSGI服务器，管理多个Uvicorn工作进程，实现高并发处理能力。数据存储层由MySQL和Redis组成，分别负责持久化数据和缓存。</p><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph TD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Client[客户端] --&gt; NginxServer[Nginx服务器]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NginxServer --&gt; |反向代理| FrontendApp[前端应用]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NginxServer --&gt; |API请求| BackendApp[后端应用]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BackendApp --&gt; GunicornServer[Gunicorn服务器]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">GunicornServer --&gt; Worker1[Uvicorn Worker 1]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">GunicornServer --&gt; Worker2[Uvicorn Worker 2]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">GunicornServer --&gt; Worker3[Uvicorn Worker 3]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">GunicornServer --&gt; Worker4[Uvicorn Worker 4]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BackendApp --&gt; MySQLDB[(MySQL数据库)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BackendApp --&gt; RedisCache[(Redis缓存)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BackendApp --&gt; ExternalAPIs[(外部API服务)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style Client fill:#2196F3,stroke:#1976D2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style NginxServer fill:#2196F3,stroke:#1976D2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style FrontendApp fill:#4CAF50,stroke:#388E3C</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style BackendApp fill:#FF9800,stroke:#F57C00</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style GunicornServer fill:#FF5722,stroke:#D84315</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style Worker1 fill:#FFC107,stroke:#FFA000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style Worker2 fill:#FFC107,stroke:#FFA000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style Worker3 fill:#FFC107,stroke:#FFA000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style Worker4 fill:#FFC107,stroke:#FFA000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style MySQLDB fill:#009688,stroke:#00796B</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style RedisCache fill:#E91E63,stroke:#C2185B</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style ExternalAPIs fill:#9C27B0,stroke:#7B1FA2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><strong>图示来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/docker/docker-compose.prod.yml#L6-L13" target="_blank" rel="noreferrer">docker-compose.prod.yml</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/docker/nginx.conf#L66-L101" target="_blank" rel="noreferrer">nginx.conf</a></li></ul><h2 id="详细组件分析" tabindex="-1">详细组件分析 <a class="header-anchor" href="#详细组件分析" aria-label="Permalink to &quot;详细组件分析&quot;">​</a></h2><h3 id="后端服务分析" tabindex="-1">后端服务分析 <a class="header-anchor" href="#后端服务分析" aria-label="Permalink to &quot;后端服务分析&quot;">​</a></h3><p>后端服务采用Gunicorn多工作进程模式部署，每个工作进程运行一个Uvicorn Worker，实现异步高性能处理。</p><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sequenceDiagram</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant Client as &quot;客户端&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant Nginx as &quot;Nginx&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant Gunicorn as &quot;Gunicorn&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant Uvicorn as &quot;Uvicorn Worker&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant Database as &quot;数据库&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Client-&gt;&gt;Nginx : HTTP请求</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Nginx-&gt;&gt;Gunicorn : 转发请求</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Gunicorn-&gt;&gt;Uvicorn : 分配到工作进程</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Uvicorn-&gt;&gt;Uvicorn : 处理FastAPI应用</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">alt 数据库操作</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Uvicorn-&gt;&gt;Database : 查询/更新</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Database--&gt;&gt;Uvicorn : 返回结果</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Uvicorn--&gt;&gt;Gunicorn : 返回响应</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Gunicorn--&gt;&gt;Nginx : 返回响应</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Nginx--&gt;&gt;Client : 返回最终响应</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Note over Gunicorn,Uvicorn : Gunicorn管理4个Uvicorn工作进程</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>图示来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/docker/docker-compose.prod.yml#L13" target="_blank" rel="noreferrer">docker-compose.prod.yml</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/main.py#L102-L108" target="_blank" rel="noreferrer">main.py</a></li></ul><p><strong>本节来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/docker/docker-compose.prod.yml#L6-L20" target="_blank" rel="noreferrer">docker-compose.prod.yml</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/main.py#L1-L108" target="_blank" rel="noreferrer">main.py</a></li></ul><h3 id="前端服务分析" tabindex="-1">前端服务分析 <a class="header-anchor" href="#前端服务分析" aria-label="Permalink to &quot;前端服务分析&quot;">​</a></h3><p>前端服务采用多阶段Docker构建，首先在构建阶段安装依赖并构建生产版本，然后在运行阶段使用轻量级Nginx容器提供服务。</p><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flowchart TD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Start([开始]) --&gt; BuildStage[&quot;构建阶段 (Node)&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BuildStage --&gt; CopyPackage[&quot;复制package.json&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CopyPackage --&gt; InstallDeps[&quot;安装生产依赖&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">InstallDeps --&gt; CopySource[&quot;复制源代码&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CopySource --&gt; BuildProd[&quot;构建生产版本&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BuildProd --&gt; ProductionStage[&quot;运行阶段 (Nginx)&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ProductionStage --&gt; CopyNginx[&quot;复制Nginx配置&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CopyNginx --&gt; CopyDist[&quot;复制构建结果&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CopyDist --&gt; StartNginx[&quot;启动Nginx服务&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">StartNginx --&gt; End([服务就绪])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style BuildStage fill:#4CAF50,stroke:#388E3C</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style ProductionStage fill:#2196F3,stroke:#1976D2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>图示来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/docker/Dockerfile.frontend.prod#L1-L41" target="_blank" rel="noreferrer">Dockerfile.frontend.prod</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/docker/nginx.conf#L1-L101" target="_blank" rel="noreferrer">nginx.conf</a></li></ul><p><strong>本节来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/docker/Dockerfile.frontend.prod#L1-L41" target="_blank" rel="noreferrer">Dockerfile.frontend.prod</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/docker/nginx.conf#L1-L101" target="_blank" rel="noreferrer">nginx.conf</a></li></ul><h3 id="数据库服务分析" tabindex="-1">数据库服务分析 <a class="header-anchor" href="#数据库服务分析" aria-label="Permalink to &quot;数据库服务分析&quot;">​</a></h3><p>MySQL和Redis服务在生产环境中进行了专门的性能优化配置。</p><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">classDiagram</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">class MySQLConfig {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+innodb_buffer_pool_size : 1G</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+max_connections : 1000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+query_cache_size : 256M</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+default_authentication_plugin : mysql_native_password</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">class RedisConfig {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+appendonly : yes</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+maxmemory : 512mb</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+maxmemory_policy : allkeys-lru</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">class EnvironmentVariables {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+MYSQL_ROOT_PASSWORD : \${MYSQL_ROOT_PASSWORD}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+MYSQL_PASSWORD : \${MYSQL_PASSWORD}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+REDIS_PASSWORD : \${REDIS_PASSWORD}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MySQLConfig --&gt; EnvironmentVariables : &quot;使用&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RedisConfig --&gt; EnvironmentVariables : &quot;使用&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>图示来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/docker/docker-compose.prod.yml#L36-L52" target="_blank" rel="noreferrer">docker-compose.prod.yml</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/docker/docker.env.example#L45-L52" target="_blank" rel="noreferrer">docker.env.example</a></li></ul><p><strong>本节来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/docker/docker-compose.prod.yml#L36-L52" target="_blank" rel="noreferrer">docker-compose.prod.yml</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/docker/docker.env.example#L45-L52" target="_blank" rel="noreferrer">docker.env.example</a></li></ul><h3 id="nginx配置分析" tabindex="-1">Nginx配置分析 <a class="header-anchor" href="#nginx配置分析" aria-label="Permalink to &quot;Nginx配置分析&quot;">​</a></h3><p>Nginx配置包含了反向代理、静态资源缓存、Gzip压缩和安全头等生产环境关键配置。</p><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flowchart TD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Request[HTTP请求] --&gt; StaticCheck[&quot;检查静态资源&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">StaticCheck --&gt; |JS/CSS/PNG等| StaticCache[&quot;设置长期缓存&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">StaticCache --&gt; SetHeaders[&quot;添加缓存头&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SetHeaders --&gt; Expires[&quot;expires 1y&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SetHeaders --&gt; CacheControl[&quot;Cache-Control: public, immutable&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SetHeaders --&gt; Response[&quot;返回响应&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">StaticCheck --&gt; |HTML文件| NoCache[&quot;设置不缓存&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NoCache --&gt; NoCacheHeaders[&quot;添加不缓存头&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NoCacheHeaders --&gt; NoExpires[&quot;expires -1&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NoCacheHeaders --&gt; NoCacheControl[&quot;Cache-Control: no-cache, no-store, must-revalidate&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NoCacheHeaders --&gt; Response</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">StaticCheck --&gt; |API请求| ReverseProxy[&quot;反向代理到后端&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ReverseProxy --&gt; GzipCheck[&quot;检查Gzip压缩&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">GzipCheck --&gt; |可压缩类型| GzipOn[&quot;启用Gzip&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">GzipOn --&gt; GzipLevel[&quot;压缩级别6&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">GzipOn --&gt; Response</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">StaticCheck --&gt; |其他| SecurityHeaders[&quot;添加安全头&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SecurityHeaders --&gt; XFrame[&quot;X-Frame-Options: DENY&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SecurityHeaders --&gt; ContentType[&quot;X-Content-Type-Options: nosniff&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SecurityHeaders --&gt; XSS[&quot;X-XSS-Protection: 1; mode=block&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SecurityHeaders --&gt; Response</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style StaticCache fill:#4CAF50,stroke:#388E3C</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style NoCache fill:#F44336,stroke:#D32F2F</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style ReverseProxy fill:#2196F3,stroke:#1976D2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style GzipOn fill:#FF9800,stroke:#F57C00</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style SecurityHeaders fill:#9C27B0,stroke:#7B1FA2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p><strong>图示来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/docker/nginx.conf#L66-L101" target="_blank" rel="noreferrer">nginx.conf</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/docker/Dockerfile.frontend.prod#L32" target="_blank" rel="noreferrer">Dockerfile.frontend.prod</a></li></ul><p><strong>本节来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/docker/nginx.conf#L1-L101" target="_blank" rel="noreferrer">nginx.conf</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/docker/Dockerfile.frontend.prod#L32" target="_blank" rel="noreferrer">Dockerfile.frontend.prod</a></li></ul><h2 id="依赖分析" tabindex="-1">依赖分析 <a class="header-anchor" href="#依赖分析" aria-label="Permalink to &quot;依赖分析&quot;">​</a></h2><p>系统各组件之间的依赖关系清晰，通过Docker Compose进行编排管理。</p><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph TD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">docker-compose.prod.yml --&gt; backend</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">docker-compose.prod.yml --&gt; frontend</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">docker-compose.prod.yml --&gt; mysql</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">docker-compose.prod.yml --&gt; redis</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">backend --&gt; Gunicorn</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">backend --&gt; Uvicorn</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">backend --&gt; settings.py</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">backend --&gt; config.yaml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">frontend --&gt; Dockerfile.frontend.prod</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">frontend --&gt; nginx.conf</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">frontend --&gt; build-stage</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">frontend --&gt; production-stage</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mysql --&gt; MySQLConfig</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">redis --&gt; RedisConfig</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Environment --&gt; docker.env.example</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">docker.env.example --&gt; MYSQL_ROOT_PASSWORD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">docker.env.example --&gt; MYSQL_PASSWORD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">docker.env.example --&gt; REDIS_PASSWORD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">docker.env.example --&gt; JWT_SECRET_KEY</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">start.sh --&gt; docker-compose</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">stop.sh --&gt; docker-compose</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style docker-compose.prod.yml fill:#FF5722,stroke:#D84315</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style backend fill:#FF9800,stroke:#F57C00</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style frontend fill:#4CAF50,stroke:#388E3C</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style mysql fill:#009688,stroke:#00796B</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style redis fill:#E91E63,stroke:#C2185B</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style start.sh fill:#2196F3,stroke:#1976D2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style stop.sh fill:#2196F3,stroke:#1976D2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p><strong>图示来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/docker/docker-compose.prod.yml#L1-L52" target="_blank" rel="noreferrer">docker-compose.prod.yml</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/docker/docker.env.example#L1-L73" target="_blank" rel="noreferrer">docker.env.example</a></li></ul><p><strong>本节来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/docker/docker-compose.prod.yml#L1-L52" target="_blank" rel="noreferrer">docker-compose.prod.yml</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/docker/docker.env.example#L1-L73" target="_blank" rel="noreferrer">docker.env.example</a></li></ul><h2 id="性能考虑" tabindex="-1">性能考虑 <a class="header-anchor" href="#性能考虑" aria-label="Permalink to &quot;性能考虑&quot;">​</a></h2><p>生产环境的性能优化主要体现在以下几个方面：</p><ol><li><strong>后端性能</strong>：使用Gunicorn管理4个Uvicorn工作进程，充分利用多核CPU，提高并发处理能力。</li><li><strong>数据库性能</strong>：MySQL配置了1GB的InnoDB缓冲池和1000的最大连接数，Redis配置了512MB的最大内存和LRU淘汰策略。</li><li><strong>前端性能</strong>：Nginx配置了静态资源的长期缓存（1年）和Gzip压缩，减少网络传输量。</li><li><strong>安全性能</strong>：Nginx配置了X-Frame-Options、X-Content-Type-Options等安全头，提高应用安全性。</li></ol><p><strong>本节来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/docker/docker-compose.prod.yml#L13-L52" target="_blank" rel="noreferrer">docker-compose.prod.yml</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/docker/nginx.conf#L34-L65" target="_blank" rel="noreferrer">nginx.conf</a></li></ul><h2 id="故障排除指南" tabindex="-1">故障排除指南 <a class="header-anchor" href="#故障排除指南" aria-label="Permalink to &quot;故障排除指南&quot;">​</a></h2><p>当部署出现问题时，可以按照以下步骤进行排查：</p><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flowchart TD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Start[部署问题] --&gt; CheckStatus[&quot;检查服务状态&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CheckStatus --&gt; docker-compose-ps[&quot;运行 docker-compose ps&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">docker-compose-ps --&gt; AllRunning[&quot;所有服务都在运行?&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AllRunning --&gt; |否| CheckLogs[&quot;查看日志&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AllRunning --&gt; |是| CheckHealth[&quot;检查健康状态&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CheckLogs --&gt; docker-compose-logs[&quot;运行 docker-compose logs&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">docker-compose-logs --&gt; IdentifyError[&quot;识别错误信息&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">IdentifyError --&gt; FixIssue[&quot;解决问题&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FixIssue --&gt; RecheckStatus[&quot;重新检查状态&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CheckHealth --&gt; curl-health[&quot;curl http://localhost:7860/health&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">curl-health --&gt; HealthOK[&quot;返回200?&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HealthOK --&gt; |否| CheckBackend[&quot;检查后端服务&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HealthOK --&gt; |是| CheckFrontend[&quot;检查前端访问&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CheckBackend --&gt; CheckGunicorn[&quot;Gunicorn是否正常启动?&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CheckBackend --&gt; CheckDependencies[&quot;依赖服务是否就绪?&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CheckFrontend --&gt; AccessFrontend[&quot;能否访问 http://localhost:8090?&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AccessFrontend --&gt; |否| CheckNginx[&quot;检查Nginx配置&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AccessFrontend --&gt; |是| FunctionTest[&quot;功能测试&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FunctionTest --&gt; APIAccess[&quot;API是否可访问?&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">APIAccess --&gt; |否| CheckProxy[&quot;检查Nginx反向代理&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">APIAccess --&gt; |是| Complete[&quot;部署成功&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style Start fill:#FF5722,stroke:#D84315</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style Complete fill:#4CAF50,stroke:#388E3C</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style CheckLogs fill:#2196F3,stroke:#1976D2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style IdentifyError fill:#FF9800,stroke:#F57C00</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p><strong>本节来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/docker/start.sh#L34-L35" target="_blank" rel="noreferrer">start.sh</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/docker/nginx.conf#L95-L98" target="_blank" rel="noreferrer">nginx.conf</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/main.py#L24-L26" target="_blank" rel="noreferrer">main.py</a></li></ul><h2 id="结论" tabindex="-1">结论 <a class="header-anchor" href="#结论" aria-label="Permalink to &quot;结论&quot;">​</a></h2><p>本指南详细介绍了AgentChat系统的生产环境部署方案。通过<code>docker-compose.prod.yml</code>文件，我们实现了后端Gunicorn多工作进程部署、前端生产镜像构建、MySQL和Redis的性能优化配置。Nginx配置文件提供了反向代理、静态资源缓存、Gzip压缩和安全头等关键生产环境特性。通过环境变量注入敏感信息，确保了配置的安全性。建议在生产环境中结合Let&#39;s Encrypt配置HTTPS，以提供更安全的通信。部署后，应通过提供的验证步骤确保所有高可用性和性能优化措施均已生效。</p>`,70)])])}const d=n(l,[["render",p]]);export{E as __pageData,d as default};
