import{_ as a,c as n,o as e,ag as i}from"./chunks/framework.D0TaUBpX.js";const k=JSON.parse('{"title":"AgentChat核心功能模块深度解析","description":"","frontmatter":{},"headers":[],"relativePath":"核心功能模块/核心功能模块.md","filePath":"核心功能模块/核心功能模块.md","lastUpdated":1764244560000}'),t={name:"核心功能模块/核心功能模块.md"};function l(r,s,p,h,c,E){return e(),n("div",null,[...s[0]||(s[0]=[i(`<h1 id="agentchat核心功能模块深度解析" tabindex="-1">AgentChat核心功能模块深度解析 <a class="header-anchor" href="#agentchat核心功能模块深度解析" aria-label="Permalink to &quot;AgentChat核心功能模块深度解析&quot;">​</a></h1><p><strong>本文档引用的文件</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/core/agents/react_agent.py" target="_blank" rel="noreferrer">react_agent.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/core/agents/plan_execute_agent.py" target="_blank" rel="noreferrer">plan_execute_agent.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/core/agents/mcp_agent.py" target="_blank" rel="noreferrer">mcp_agent.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/rag/parser.py" target="_blank" rel="noreferrer">parser.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/memory/vector_stores/chroma.py" target="_blank" rel="noreferrer">chroma.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/rag/embedding.py" target="_blank" rel="noreferrer">embedding.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/retrieval.py" target="_blank" rel="noreferrer">retrieval.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/mcp/manager.py" target="_blank" rel="noreferrer">manager.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/mcp/multi_client.py" target="_blank" rel="noreferrer">multi_client.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/tools/__init__.py" target="_blank" rel="noreferrer"><strong>init</strong>.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/mcp_servers/weather/mcp_weather.py" target="_blank" rel="noreferrer">mcp_weather.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/mcp_servers/lark_mcp/main.py" target="_blank" rel="noreferrer">main.py</a></li></ul><h2 id="目录" tabindex="-1">目录 <a class="header-anchor" href="#目录" aria-label="Permalink to &quot;目录&quot;">​</a></h2><ol><li><a href="#引言">引言</a></li><li><a href="#多agent系统">多Agent系统</a></li><li><a href="#知识库系统">知识库系统</a></li><li><a href="#工具生态系统">工具生态系统</a></li><li><a href="#mcp集成">MCP集成</a></li><li><a href="#架构概览">架构概览</a></li><li><a href="#总结">总结</a></li></ol><h2 id="引言" tabindex="-1">引言 <a class="header-anchor" href="#引言" aria-label="Permalink to &quot;引言&quot;">​</a></h2><p>AgentChat作为一个先进的多模态AI代理平台，集成了四大核心功能模块：多Agent系统、知识库系统、工具生态系统和MCP集成。这些模块协同工作，为用户提供智能化的对话体验和强大的功能扩展能力。</p><h2 id="多agent系统" tabindex="-1">多Agent系统 <a class="header-anchor" href="#多agent系统" aria-label="Permalink to &quot;多Agent系统&quot;">​</a></h2><p>多Agent系统是AgentChat的核心架构，支持多种执行模式和协作机制，能够根据不同的应用场景选择最适合的代理策略。</p><h3 id="agent类型与执行模式" tabindex="-1">Agent类型与执行模式 <a class="header-anchor" href="#agent类型与执行模式" aria-label="Permalink to &quot;Agent类型与执行模式&quot;">​</a></h3><p>AgentChat实现了三种主要的Agent执行模式：</p><h4 id="react-agent-推理-行动模式" tabindex="-1">React Agent（推理-行动模式） <a class="header-anchor" href="#react-agent-推理-行动模式" aria-label="Permalink to &quot;React Agent（推理-行动模式）&quot;">​</a></h4><p>React Agent采用ReAct框架，通过推理和行动的循环来解决问题。</p><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flowchart TD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Start([开始]) --&gt; InitGraph[&quot;初始化LangGraph&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">InitGraph --&gt; CallTool[&quot;调用工具节点&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CallTool --&gt; HasTool{&quot;是否有工具调用?&quot;}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HasTool --&gt; |是| ExecuteTool[&quot;执行工具节点&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HasTool --&gt; |否| End([结束])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ExecuteTool --&gt; CallTool</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CallTool --&gt; ShouldContinue{&quot;是否继续?&quot;}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ShouldContinue --&gt; |是| ExecuteTool</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ShouldContinue --&gt; |否| End</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>图表来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/core/agents/react_agent.py#L82-L96" target="_blank" rel="noreferrer">react_agent.py</a></li></ul><p>React Agent的核心特性包括：</p><ul><li><strong>流式输出支持</strong>：实时传输事件和响应块</li><li><strong>工具调用链</strong>：支持多个工具的连续调用</li><li><strong>状态管理</strong>：维护工具调用计数和模型调用计数</li><li><strong>错误处理</strong>：完善的异常捕获和恢复机制</li></ul><h4 id="plan-execute-agent-计划-执行模式" tabindex="-1">Plan-Execute Agent（计划-执行模式） <a class="header-anchor" href="#plan-execute-agent-计划-执行模式" aria-label="Permalink to &quot;Plan-Execute Agent（计划-执行模式）&quot;">​</a></h4><p>Plan-Execute Agent采用战略规划驱动的方法，先制定执行计划再执行工具调用。</p><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sequenceDiagram</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant User as 用户</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant Agent as Plan-Execute Agent</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant Planner as 计划器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant Executor as 执行器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant Tools as 工具集合</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">User-&gt;&gt;Agent : 提交请求</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Agent-&gt;&gt;Planner : 分析用户查询</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Planner-&gt;&gt;Planner : 创建执行计划</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Planner--&gt;&gt;Agent : 返回计划</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Agent-&gt;&gt;Executor : 执行计划步骤</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">loop 每个计划步骤</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Executor-&gt;&gt;Tools : 调用相应工具</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Tools--&gt;&gt;Executor : 返回结果</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Executor-&gt;&gt;Executor : 收集工具结果</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Executor--&gt;&gt;Agent : 返回所有结果</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Agent-&gt;&gt;Agent : 生成最终响应</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Agent--&gt;&gt;User : 返回结果</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>图表来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/core/agents/plan_execute_agent.py#L95-L155" target="_blank" rel="noreferrer">plan_execute_agent.py</a></li></ul><h4 id="mcp-agent-模型上下文协议代理" tabindex="-1">MCP Agent（模型上下文协议代理） <a class="header-anchor" href="#mcp-agent-模型上下文协议代理" aria-label="Permalink to &quot;MCP Agent（模型上下文协议代理）&quot;">​</a></h4><p>MCP Agent专门处理与MCP服务器的交互，将外部服务作为工具集成到代理系统中。</p><h3 id="agent配置与管理" tabindex="-1">Agent配置与管理 <a class="header-anchor" href="#agent配置与管理" aria-label="Permalink to &quot;Agent配置与管理&quot;">​</a></h3><p>Agent的创建和配置涉及多个方面：</p><table tabindex="0"><thead><tr><th>配置项</th><th>描述</th><th>默认值</th><th>用途</th></tr></thead><tbody><tr><td>model</td><td>对话模型实例</td><td>OpenAI GPT-4</td><td>处理自然语言理解和生成</td></tr><tr><td>system_prompt</td><td>系统提示词</td><td>DEFAULT_CALL_PROMPT</td><td>定义代理行为规范</td></tr><tr><td>tools</td><td>工具列表</td><td>[]</td><td>可用的功能扩展</td></tr><tr><td>mcp_config</td><td>MCP配置</td><td>None</td><td>外部服务集成</td></tr></tbody></table><p><strong>章节来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/core/agents/react_agent.py#L45-L54" target="_blank" rel="noreferrer">react_agent.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/core/agents/plan_execute_agent.py#L71-L82" target="_blank" rel="noreferrer">plan_execute_agent.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/core/agents/mcp_agent.py#L26-L32" target="_blank" rel="noreferrer">mcp_agent.py</a></li></ul><h2 id="知识库系统" tabindex="-1">知识库系统 <a class="header-anchor" href="#知识库系统" aria-label="Permalink to &quot;知识库系统&quot;">​</a></h2><p>知识库系统提供了完整的RAG（检索增强生成）解决方案，支持多种文档格式的处理和向量化存储。</p><h3 id="文档处理与解析" tabindex="-1">文档处理与解析 <a class="header-anchor" href="#文档处理与解析" aria-label="Permalink to &quot;文档处理与解析&quot;">​</a></h3><p>系统支持多种文档格式的自动解析：</p><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flowchart LR</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Input[输入文档] --&gt; DetectFormat[&quot;检测文件格式&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DetectFormat --&gt; PDF[PDF解析器]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DetectFormat --&gt; DOCX[DOCX解析器]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DetectFormat --&gt; TXT[文本解析器]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DetectFormat --&gt; MD[Markdown解析器]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PDF --&gt; ChunkGen[&quot;生成文本块&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DOCX --&gt; ChunkGen</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TXT --&gt; ChunkGen</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MD --&gt; ChunkGen</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ChunkGen --&gt; Summarize[&quot;生成摘要&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Summarize --&gt; Embedding[&quot;向量化处理&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Embedding --&gt; Store[&quot;存储到向量数据库&quot;]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>图表来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/rag/parser.py#L15-L37" target="_blank" rel="noreferrer">parser.py</a></li></ul><h3 id="向量存储与检索" tabindex="-1">向量存储与检索 <a class="header-anchor" href="#向量存储与检索" aria-label="Permalink to &quot;向量存储与检索&quot;">​</a></h3><p>AgentChat支持多种向量数据库：</p><h4 id="chromadb集成" tabindex="-1">ChromaDB集成 <a class="header-anchor" href="#chromadb集成" aria-label="Permalink to &quot;ChromaDB集成&quot;">​</a></h4><ul><li><strong>本地存储</strong>：支持本地文件系统存储</li><li><strong>远程连接</strong>：支持HTTP客户端连接</li><li><strong>持久化</strong>：自动数据持久化机制</li><li><strong>批量操作</strong>：高效的批量插入和查询</li></ul><h4 id="milvus集成" tabindex="-1">Milvus集成 <a class="header-anchor" href="#milvus集成" aria-label="Permalink to &quot;Milvus集成&quot;">​</a></h4><ul><li><strong>高性能检索</strong>：支持大规模向量相似度搜索</li><li><strong>混合检索</strong>：结合Elasticsearch和Milvus的优势</li><li><strong>多维度过滤</strong>：支持复杂的查询条件</li></ul><h3 id="rag检索流程" tabindex="-1">RAG检索流程 <a class="header-anchor" href="#rag检索流程" aria-label="Permalink to &quot;RAG检索流程&quot;">​</a></h3><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sequenceDiagram</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant User as 用户</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant RAG as RAG处理器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant Parser as 文档解析器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant Embedder as 嵌入模型</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant VectorDB as 向量数据库</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant Retriever as 检索器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">User-&gt;&gt;RAG : 提交查询</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RAG-&gt;&gt;Embedder : 生成查询嵌入</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Embedder--&gt;&gt;RAG : 返回向量表示</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RAG-&gt;&gt;VectorDB : 向量相似度搜索</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">VectorDB--&gt;&gt;RAG : 返回相关文档</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RAG-&gt;&gt;Retriever : 重排序和筛选</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Retriever--&gt;&gt;RAG : 最终结果</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RAG-&gt;&gt;RAG : 构建上下文</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RAG--&gt;&gt;User : 返回增强回答</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><strong>图表来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/rag/embedding.py#L11-L43" target="_blank" rel="noreferrer">embedding.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/retrieval.py#L5-L46" target="_blank" rel="noreferrer">retrieval.py</a></li></ul><p><strong>章节来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/rag/parser.py#L13-L58" target="_blank" rel="noreferrer">parser.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/memory/vector_stores/chroma.py#L23-L255" target="_blank" rel="noreferrer">chroma.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/rag/embedding.py#L1-L50" target="_blank" rel="noreferrer">embedding.py</a></li></ul><h2 id="工具生态系统" tabindex="-1">工具生态系统 <a class="header-anchor" href="#工具生态系统" aria-label="Permalink to &quot;工具生态系统&quot;">​</a></h2><p>AgentChat提供了丰富的内置工具和灵活的扩展机制，支持各种实用功能的集成。</p><h3 id="内置工具分类" tabindex="-1">内置工具分类 <a class="header-anchor" href="#内置工具分类" aria-label="Permalink to &quot;内置工具分类&quot;">​</a></h3><p>系统提供了九种主要的内置工具：</p><table tabindex="0"><thead><tr><th>工具类别</th><th>工具名称</th><th>功能描述</th><th>使用场景</th></tr></thead><tbody><tr><td>通信工具</td><td>send_email</td><td>邮件发送功能</td><td>自动化邮件通知</td></tr><tr><td>搜索工具</td><td>tavily_search</td><td>网页搜索</td><td>信息检索</td></tr><tr><td>搜索工具</td><td>google_search</td><td>Google搜索</td><td>通用网络查询</td></tr><tr><td>数据工具</td><td>get_arxiv</td><td>学术论文检索</td><td>科研辅助</td></tr><tr><td>生活工具</td><td>get_weather</td><td>天气查询</td><td>实时天气信息</td></tr><tr><td>物流工具</td><td>get_delivery_info</td><td>快递查询</td><td>物流跟踪</td></tr><tr><td>转换工具</td><td>convert_to_pdf</td><td>文档转换</td><td>格式转换</td></tr><tr><td>转换工具</td><td>convert_to_docx</td><td>文档转换</td><td>格式转换</td></tr><tr><td>媒体工具</td><td>text_to_image</td><td>文本转图像</td><td>创意设计</td></tr><tr><td>媒体工具</td><td>image_to_text</td><td>图像转文本</td><td>OCR识别</td></tr></tbody></table><h3 id="工具调用机制" tabindex="-1">工具调用机制 <a class="header-anchor" href="#工具调用机制" aria-label="Permalink to &quot;工具调用机制&quot;">​</a></h3><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">classDiagram</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">class ToolRegistry {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+Dict~str, BaseTool~ tools</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+register_tool(name, tool)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+get_tool(name)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+list_tools()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">class BaseTool {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+str name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+str description</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+Schema args_schema</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+coroutine func</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+invoke(args)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+ainvoke(args)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">class ToolExecutor {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+BaseTool[] available_tools</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+execute_tool(name, args)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+batch_execute(tools_info)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ToolRegistry --&gt; BaseTool</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ToolExecutor --&gt; BaseTool</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BaseTool &lt;|-- WeatherTool</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BaseTool &lt;|-- SearchTool</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BaseTool &lt;|-- EmailTool</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><strong>图表来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/tools/__init__.py#L13-L48" target="_blank" rel="noreferrer"><strong>init</strong>.py</a></li></ul><h3 id="自定义工具扩展" tabindex="-1">自定义工具扩展 <a class="header-anchor" href="#自定义工具扩展" aria-label="Permalink to &quot;自定义工具扩展&quot;">​</a></h3><p>开发者可以通过以下方式扩展工具生态系统：</p><ol><li><strong>工具注册</strong>：将新工具添加到工具注册表</li><li><strong>参数验证</strong>：使用Pydantic Schema进行参数验证</li><li><strong>异步支持</strong>：支持同步和异步工具函数</li><li><strong>错误处理</strong>：统一的错误处理和日志记录</li></ol><p><strong>章节来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/tools/__init__.py#L1-L48" target="_blank" rel="noreferrer"><strong>init</strong>.py</a></li></ul><h2 id="mcp集成" tabindex="-1">MCP集成 <a class="header-anchor" href="#mcp集成" aria-label="Permalink to &quot;MCP集成&quot;">​</a></h2><p>MCP（Model Context Protocol）集成使AgentChat能够无缝连接外部服务和工具，实现真正的插件化架构。</p><h3 id="mcp协议概述" tabindex="-1">MCP协议概述 <a class="header-anchor" href="#mcp协议概述" aria-label="Permalink to &quot;MCP协议概述&quot;">​</a></h3><p>MCP协议提供了一套标准接口，允许外部服务以标准化的方式与AI代理交互：</p><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph TB</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subgraph &quot;AgentChat核心&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Agent[代理实例]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MCPManager[MCP管理器]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MultiClient[多客户端]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subgraph &quot;MCP服务器&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">WeatherServer[天气服务]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LarkServer[飞书服务]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CustomServer[自定义服务]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subgraph &quot;外部服务&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">API1[REST API]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">API2[WebSocket]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CLI[命令行工具]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Agent --&gt; MCPManager</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MCPManager --&gt; MultiClient</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MultiClient --&gt; WeatherServer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MultiClient --&gt; LarkServer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MultiClient --&gt; CustomServer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">WeatherServer --&gt; API1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LarkServer --&gt; API2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CustomServer --&gt; CLI</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><strong>图表来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/mcp/manager.py#L13-L25" target="_blank" rel="noreferrer">manager.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/mcp/multi_client.py#L42-L95" target="_blank" rel="noreferrer">multi_client.py</a></li></ul><h3 id="mcp服务器管理" tabindex="-1">MCP服务器管理 <a class="header-anchor" href="#mcp服务器管理" aria-label="Permalink to &quot;MCP服务器管理&quot;">​</a></h3><h4 id="服务器配置" tabindex="-1">服务器配置 <a class="header-anchor" href="#服务器配置" aria-label="Permalink to &quot;服务器配置&quot;">​</a></h4><p>MCP服务器通过配置对象进行管理：</p><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">classDiagram</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">class MCPConfig {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+str url</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+str type</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+str[] tools</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+str server_name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+str mcp_server_id</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">class MCPManager {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+MCPBaseConfig[] mcp_configs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+MultiServerMCPClient multi_server_client</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+int timeout</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+get_mcp_tools()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+show_mcp_tools()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+call_mcp_tools(tools_info)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">class MultiServerMCPClient {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+Dict~str, Connection~ connections</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+session(server_name)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+get_tools(server_name)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+get_prompt(server_name, prompt_name)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+get_resources(server_name, uris)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MCPManager --&gt; MCPConfig</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MCPManager --&gt; MultiServerMCPClient</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><strong>图表来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/core/agents/mcp_agent.py#L18-L24" target="_blank" rel="noreferrer">mcp_agent.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/mcp/manager.py#L13-L25" target="_blank" rel="noreferrer">manager.py</a></li></ul><h4 id="连接类型支持" tabindex="-1">连接类型支持 <a class="header-anchor" href="#连接类型支持" aria-label="Permalink to &quot;连接类型支持&quot;">​</a></h4><p>AgentChat支持多种MCP连接方式：</p><table tabindex="0"><thead><tr><th>连接类型</th><th>描述</th><th>使用场景</th></tr></thead><tbody><tr><td>SSE</td><td>服务器发送事件</td><td>实时数据推送</td></tr><tr><td>HTTP</td><td>HTTP请求响应</td><td>RESTful API调用</td></tr><tr><td>WebSocket</td><td>双向通信</td><td>实时交互应用</td></tr><tr><td>STDIO</td><td>标准输入输出</td><td>命令行工具集成</td></tr></tbody></table><h3 id="外部服务集成示例" tabindex="-1">外部服务集成示例 <a class="header-anchor" href="#外部服务集成示例" aria-label="Permalink to &quot;外部服务集成示例&quot;">​</a></h3><h4 id="天气服务集成" tabindex="-1">天气服务集成 <a class="header-anchor" href="#天气服务集成" aria-label="Permalink to &quot;天气服务集成&quot;">​</a></h4><p>天气服务展示了如何将外部API集成到MCP框架中：</p><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sequenceDiagram</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant Agent as AgentChat</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant MCP as MCP管理器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant Weather as 天气服务</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">participant API as 天气API</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Agent-&gt;&gt;MCP : 请求天气信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MCP-&gt;&gt;Weather : 创建MCP会话</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Weather-&gt;&gt;API : 发送API请求</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">API--&gt;&gt;Weather : 返回天气数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Weather--&gt;&gt;MCP : 格式化响应</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MCP--&gt;&gt;Agent : 返回处理结果</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>图表来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/mcp_servers/weather/mcp_weather.py#L15-L48" target="_blank" rel="noreferrer">mcp_weather.py</a></li></ul><h4 id="飞书服务集成" tabindex="-1">飞书服务集成 <a class="header-anchor" href="#飞书服务集成" aria-label="Permalink to &quot;飞书服务集成&quot;">​</a></h4><p>飞书服务提供了企业级的办公自动化功能：</p><ul><li><strong>日历管理</strong>：会议安排和时间管理</li><li><strong>文档处理</strong>：文档创建和编辑</li><li><strong>消息发送</strong>：群组消息通知</li><li><strong>用户信息</strong>：组织架构查询</li></ul><h3 id="mcp工具调用流程" tabindex="-1">MCP工具调用流程 <a class="header-anchor" href="#mcp工具调用流程" aria-label="Permalink to &quot;MCP工具调用流程&quot;">​</a></h3><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flowchart TD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Start([开始调用]) --&gt; LoadTools[&quot;加载MCP工具&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LoadTools --&gt; ValidateArgs[&quot;验证参数&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ValidateArgs --&gt; CheckAsync{&quot;是否异步?&quot;}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CheckAsync --&gt; |是| AsyncExec[&quot;异步执行&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CheckAsync --&gt; |否| SyncExec[&quot;同步执行&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AsyncExec --&gt; LogResult[&quot;记录结果&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SyncExec --&gt; LogResult</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LogResult --&gt; HandleError{&quot;是否有错误?&quot;}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HandleError --&gt; |是| LogError[&quot;记录错误&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HandleError --&gt; |否| ReturnResult[&quot;返回结果&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LogError --&gt; ReturnError[&quot;返回错误信息&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ReturnResult --&gt; End([结束])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ReturnError --&gt; End</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>图表来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/mcp/manager.py#L61-L102" target="_blank" rel="noreferrer">manager.py</a></li></ul><p><strong>章节来源</strong></p><ul><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/mcp/manager.py#L1-L103" target="_blank" rel="noreferrer">manager.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/services/mcp/multi_client.py#L1-L226" target="_blank" rel="noreferrer">multi_client.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/mcp_servers/weather/mcp_weather.py#L1-L63" target="_blank" rel="noreferrer">mcp_weather.py</a></li><li><a href="https://github.com/Shy2593666979/AgentChat/src/backend/agentchat/mcp_servers/lark_mcp/main.py#L1-L31" target="_blank" rel="noreferrer">main.py</a></li></ul><h2 id="架构概览" tabindex="-1">架构概览 <a class="header-anchor" href="#架构概览" aria-label="Permalink to &quot;架构概览&quot;">​</a></h2><p>AgentChat的整体架构体现了模块化和可扩展性设计原则：</p><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph TB</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subgraph &quot;前端层&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Frontend[Vue.js前端]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">API[RESTful API]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subgraph &quot;业务逻辑层&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AgentCore[Agent核心]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RAGService[RAG服务]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ToolService[工具服务]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MCPService[MCP服务]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subgraph &quot;数据存储层&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">VectorDB[向量数据库]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FileStorage[文件存储]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ConfigDB[配置数据库]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subgraph &quot;外部服务&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LLM[大语言模型]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Tools[第三方工具]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MCP[外部MCP服务器]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Frontend --&gt; API</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">API --&gt; AgentCore</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">API --&gt; RAGService</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">API --&gt; ToolService</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">API --&gt; MCPService</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AgentCore --&gt; VectorDB</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RAGService --&gt; FileStorage</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ToolService --&gt; Tools</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MCPService --&gt; MCP</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AgentCore --&gt; LLM</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="核心组件交互" tabindex="-1">核心组件交互 <a class="header-anchor" href="#核心组件交互" aria-label="Permalink to &quot;核心组件交互&quot;">​</a></h3><p>各核心功能模块之间的交互关系：</p><ol><li><strong>Agent系统</strong>负责对话管理和决策制定</li><li><strong>知识库系统</strong>提供上下文增强和信息检索</li><li><strong>工具生态系统</strong>扩展基础功能</li><li><strong>MCP集成</strong>连接外部服务和专业工具</li></ol><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><p>AgentChat的四大核心功能模块构成了一个完整的AI代理生态系统：</p><ul><li><strong>多Agent系统</strong>提供了灵活的执行策略和协作机制</li><li><strong>知识库系统</strong>实现了智能的信息检索和上下文增强</li><li><strong>工具生态系统</strong>支持丰富的功能扩展和定制开发</li><li><strong>MCP集成</strong>实现了与外部服务的无缝连接</li></ul><p>这种模块化的设计使得AgentChat既具有强大的功能性，又保持了良好的可扩展性和可维护性。开发者可以根据具体需求组合不同的模块，构建满足特定场景的智能代理应用。</p><p>通过深入理解这些核心功能模块的工作原理和相互关系，开发者可以更好地利用AgentChat平台开发创新的AI应用，为用户提供更加智能和便捷的服务体验。</p>`,105)])])}const d=a(t,[["render",l]]);export{k as __pageData,d as default};
